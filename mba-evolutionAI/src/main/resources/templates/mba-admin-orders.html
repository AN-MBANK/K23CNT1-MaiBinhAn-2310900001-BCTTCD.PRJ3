<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Qu·∫£n l√Ω ƒê∆°n h√†ng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .currency-symbol::after {
            content: " ‚Ç´";
            font-weight: normal;
        }
    </style>
</head>
<body class="bg-gray-50 text-slate-800">
<div th:replace="~{fragments/mba-header :: navbar}"></div>

<div class="max-w-7xl mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold mb-6">üìù Danh s√°ch ƒê∆°n h√†ng</h1>

    <div class="mb-4 text-sm text-gray-600 flex items-center gap-4">
        <span>L·ªçc theo tr·∫°ng th√°i:</span>
        <a th:href="@{/mba-admin/orders}" class="text-gray-900 font-medium hover:underline">T·∫•t c·∫£</a>
        <a th:href="@{/mba-admin/orders(status='NEW')}" class="text-red-600 font-medium hover:underline">ƒê∆°n m·ªõi</a>
        <a th:href="@{/mba-admin/orders(status='CONFIRMED')}" class="text-blue-600 font-medium hover:underline">ƒêang chu·∫©n b·ªã</a>
        <a th:href="@{/mba-admin/orders(status='SHIPPING')}" class="text-purple-600 font-medium hover:underline">ƒêang giao</a>
        <a th:href="@{/mba-admin/orders(status='SHIPPED')}" class="text-green-600 font-medium hover:underline">ƒê√£ giao</a>
    </div>

    <div th:if="${successMessage}" class="bg-green-100 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6" th:text="${successMessage}"></div>

    <div class="bg-white rounded-xl shadow overflow-hidden border border-gray-100">
        <table class="w-full text-sm text-left">
            <thead class="bg-gray-50 uppercase text-xs border-b font-bold text-gray-500">
            <tr>
                <th class="p-4">M√£ ƒë∆°n</th>
                <th class="p-4">Ng√†y ƒë·∫∑t</th>
                <th class="p-4">Kh√°ch h√†ng</th>
                <th class="p-4">T·ªïng ti·ªÅn</th>
                <th class="p-4">Tr·∫°ng th√°i</th>
                <th class="p-4">Thao t√°c (V·∫≠n chuy·ªÉn)</th>
            </tr>
            </thead>
            <tbody class="divide-y">
            <tr th:each="order : ${orders}" class="hover:bg-gray-50">
                <td class="p-4 font-bold text-blue-600" th:text="${order.mbaOrderId}"></td>
                <td class="p-4 whitespace-nowrap text-gray-500" th:text="${#temporals.format(order.mbaOrderDate, 'dd/MM/yyyy HH:mm')}"></td>

                <td class="p-4">
                    <div class="font-bold text-gray-900" th:text="${order.mbaCustomerName}"></div>
                    <div class="text-xs text-gray-500" th:text="${order.mbaAddress}"></div>
                </td>

                <td class="p-4 font-bold text-lg currency-symbol" th:text="${#numbers.formatDecimal(order.mbaTotalAmount, 0, 'POINT', 0, 'POINT')}"></td>

                <td class="p-4">
                         <span th:classappend="${order.mbaStatus == 'NEW' ? 'bg-red-100 text-red-700' :
                                               order.mbaStatus == 'CONFIRMED' ? 'bg-blue-100 text-blue-700' :
                                               order.mbaStatus == 'SHIPPING' ? 'bg-purple-100 text-purple-700' :
                                               order.mbaStatus == 'SHIPPED' ? 'bg-green-100 text-green-700' :
                                               'bg-gray-100 text-gray-700'}"
                               class="px-2 py-1 rounded text-xs font-bold"
                               th:text="${order.mbaStatus}"></span>
                </td>

                <td class="p-4">

                    <a th:if="${order.mbaStatus == 'NEW'}"
                       th:href="@{/mba-admin/orders/update-status/{id}(id=${order.mbaOrderId}, newStatus='CONFIRMED')}"
                       class="bg-blue-100 text-blue-700 font-medium px-2 py-1 rounded text-xs hover:bg-blue-200 transition"
                       onclick="return confirm('X√°c nh·∫≠n chu·∫©n b·ªã ƒë∆°n h√†ng n√†y?')">
                        X√°c nh·∫≠n & Chu·∫©n b·ªã
                    </a>

                    <a th:if="${order.mbaStatus == 'CONFIRMED'}"
                       th:href="@{/mba-admin/orders/update-status/{id}(id=${order.mbaOrderId}, newStatus='SHIPPING')}"
                       class="bg-purple-100 text-purple-700 font-medium px-2 py-1 rounded text-xs hover:bg-purple-200 transition"
                       onclick="return confirm('ƒê√°nh d·∫•u ƒë∆°n h√†ng n√†y ƒêang Giao?')">
                        ƒêang ƒëi giao
                    </a>

                    <a th:if="${order.mbaStatus == 'SHIPPING'}"
                       th:href="@{/mba-admin/orders/update-status/{id}(id=${order.mbaOrderId}, newStatus='SHIPPED')}"
                       class="bg-green-100 text-green-700 font-medium px-2 py-1 rounded text-xs hover:bg-green-200 transition">
                        Ho√†n t·∫•t giao h√†ng
                    </a>

                    <span th:if="${order.mbaStatus == 'SHIPPED'}" class="text-gray-500 text-xs">ƒê√£ ho√†n th√†nh</span>
                    <span th:if="${order.mbaStatus == 'CANCELLED'}" class="text-red-500 text-xs">ƒê√£ b·ªã h·ªßy</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:if="${orders == null or orders.empty}" class="text-center py-10 text-gray-500">
        Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng n√†o ph√π h·ª£p v·ªõi ƒëi·ªÅu ki·ªán l·ªçc.
    </div>
</div>
<div class="max-w-7xl mx-auto px-4 pt-6">
    <a th:href="@{/mba-admin}"
       class="inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 hover:text-blue-600 hover:border-blue-300 transition-all shadow-sm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        Quay l·∫°i Dashboard
    </a>
</div>
</body>
</html>