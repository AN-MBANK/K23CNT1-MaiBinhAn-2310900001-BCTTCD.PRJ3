<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Chi tiết đơn hàng #[[${order.mbaOrderId}]]</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        @media print {
            .no-print { display: none; }
            .print-only { display: block; }
            body { background: white; padding: 0; }
            .shadow-xl { shadow: none; border: 1px solid #eee; }
        }
    </style>
</head>

<body class="bg-gray-100 p-4 md:p-8">
<div th:replace="~{fragments/mba-header :: navbar}"></div>

<div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-6 no-print">
        <a th:href="@{/mba-admin/orders}" class="flex items-center text-blue-600 hover:text-blue-800 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            Quay lại danh sách
        </a>
        <button onclick="window.print()" class="bg-slate-800 text-white px-4 py-2 rounded-lg flex items-center shadow hover:bg-slate-900 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" /></svg>
            In hóa đơn
        </button>
    </div>

    <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-200" id="invoice">
        <div class="bg-slate-900 p-8 text-white flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold tracking-tight">HÓA ĐƠN BÁN HÀNG</h1>
                <p class="text-slate-400 mt-1">Mã đơn hàng: <span class="text-white font-mono" th:text="'#' + ${order.mbaOrderId}">#12345</span></p>
            </div>
            <div class="text-right">
                <h2 class="text-xl font-bold text-blue-400">MbaEvolutionAI</h2>
                <p class="text-xs text-slate-400">Phụ kiện công nghệ cao cấp</p>
            </div>
        </div>

        <div class="p-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                <div>
                    <h3 class="text-gray-400 uppercase text-xs font-bold tracking-widest mb-3">Thông tin người nhận</h3>
                    <p class="font-bold text-lg text-slate-900" th:text="${order.mbaCustomerName}">Tên khách hàng</p>
                    <p class="text-gray-600" th:text="${order.mbaPhone}">Số điện thoại</p>
                    <p class="text-gray-600 mt-1 leading-relaxed" th:text="${order.mbaAddress}">Địa chỉ giao hàng</p>
                </div>
                <div class="md:text-right">
                    <h3 class="text-gray-400 uppercase text-xs font-bold tracking-widest mb-3">Chi tiết đơn hàng</h3>
                    <p class="text-gray-600">Ngày đặt: <span class="font-semibold text-slate-900" th:text="${#temporals.format(order.mbaOrderDate, 'dd/MM/yyyy HH:mm')}"></span></p>
                    <p class="text-gray-600 mt-1">Thanh toán: <span class="font-semibold text-slate-900" th:text="${order.mbaPaymentMethod}">COD</span></p>
                    <div class="mt-3">
                        <span class="px-3 py-1 rounded-full text-xs font-bold uppercase tracking-tighter shadow-sm"
                              th:classappend="${order.mbaStatus == 'NEW' ? 'bg-red-500 text-white' : (order.mbaStatus == 'SHIPPED' ? 'bg-green-500 text-white' : 'bg-blue-500 text-white')}"
                              th:text="${order.mbaStatus}">TRẠNG THÁI</span>
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-100 pt-8">
                <table class="w-full text-left">
                    <thead>
                    <tr class="text-gray-400 uppercase text-xs font-bold tracking-widest border-b border-gray-100">
                        <th class="pb-4">Sản phẩm</th>
                        <th class="pb-4 text-center">Số lượng</th>
                        <th class="pb-4 text-right">Đơn giá</th>
                        <th class="pb-4 text-right">Thành tiền</th>
                    </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-50">
                    <tr th:each="detail : ${order.mbaOrderDetails}">
                        <td class="py-5">
                            <p class="font-bold text-slate-800" th:text="${detail.mbaProduct.mbaName}">Tên SP</p>
                            <p class="text-xs text-gray-500" th:text="'SKU: ' + ${detail.mbaProduct.mbaProductId}">Mã SP</p>
                        </td>
                        <td class="py-5 text-center font-semibold" th:text="${detail.mbaQuantity}">1</td>
                        <td class="py-5 text-right text-gray-600" th:text="${#numbers.formatCurrency(detail.mbaPrice)}">0 đ</td>
                        <td class="py-5 text-right font-bold text-slate-900" th:text="${#numbers.formatCurrency(detail.mbaPrice * detail.mbaQuantity)}">0 đ</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="mt-8 border-t-2 border-slate-900 pt-8 flex flex-col md:flex-row justify-between items-start gap-10">

                <div class="w-full md:w-auto flex flex-col items-center md:items-start">
                    <h4 class="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] mb-2">Mã định danh đơn hàng</h4>

                    <div class="bg-white p-3 border border-gray-100 rounded-xl shadow-sm flex flex-col items-center min-w-[300px]">
                        <img th:with="orderCode='DH2025' + ${order.mbaOrderId} + 'MBAEVO'"
                             th:src="'https://bwipjs-api.metafloor.com/?bcid=code128&text=' + ${orderCode} + '&scaleX=3 &scaleY=1 &height=14 &includetext=false'"
                             alt="Order Barcode"
                             class="w-full h-auto max-h-[50px] object-contain">

                        <div class="mt-2 text-[11px] font-mono font-bold tracking-[0.4em] text-slate-600"
                             th:with="orderCode='DH2025' + ${order.mbaOrderId} + 'MBAEVO'"
                             th:text="${orderCode}">DH20256MBAEVO</div>
                    </div>

                    <p class="text-[9px] text-slate-300 italic mt-2">Quét mã để đối soát đơn hàng</p>
                </div>

                <div class="w-full md:w-72 space-y-4">
                    <div class="flex justify-between text-slate-500 text-sm border-b border-dashed pb-2">
                        <span>Tạm tính:</span>
                        <span class="font-semibold text-slate-900" th:text="${#numbers.formatCurrency(order.mbaTotalAmount)}"></span>
                    </div>
                    <div class="flex justify-between items-baseline pt-2">
                        <span class="text-sm font-bold text-slate-900 uppercase">Tổng cộng</span>
                        <span class="text-3xl font-black text-red-600 tracking-tighter"
                              th:text="${#numbers.formatCurrency(order.mbaTotalAmount)}"></span>
                    </div>
                </div>
            </div>                <p class="text-sm text-yellow-800 italic" th:text="${order.mbaNote}"></p>
            </div>
        </div>

        <div class="bg-gray-50 p-6 text-center text-gray-400 text-xs">
            Cảm ơn bạn đã tin tưởng lựa chọn sản phẩm của MbaEvolutionAI!
        </div>
    </div>
</div>

</body>
</html>